![SpreadsheetXML.com](ssImages\SpreadsheetMLBanner.png)

[主页](index.md) | [文字处理ML (docx)](anatomyofOOXML.md) | [电子表格ML (xlsx)](anatomyofOOXML-xlsx.md) | [演示文稿ML (pptx)](anatomyofOOXML-pptx.md) | [绘图ML](drwOverview.md)

- [电子表格ML文件剖析](anatomyofOOXML-xlsx.md)
- [内容概述](SScontentOverview.md)
- [样式和格式](SSstyles.md)

# 包结构

电子表格ML或.xlsx文件是一个包含多个"部件"（通常是UTF-8或UTF-16编码）或XML文件的zip文件（一个包）。该包可能还包含其他媒体文件，如图像。其结构是根据OOXML标准ECMA-376第2部分中概述的开放打包约定组织的。

您可以通过简单地解压.xlsx文件来查看电子表格ML文件的文件结构和组成文件。![电子表格ML文件结构](ssImages\rootStructure1.gif)

部件的数量和类型将根据电子表格中的内容而变化，但始终会有一个[Content_Types].xml、一个或多个关系部件、一个工作簿部件和至少一个工作表。电子表格的核心数据包含在工作表部件中，在[xsxl内容概述](SScontentOverview.md)中有更详细的讨论。

# 内容类型

每个包必须有一个[Content_Types].xml，位于包的根目录。此文件包含包中所有部件的内容类型列表。每个部件及其类型必须在[Content_Types].xml中列出。以下是主要内容部件的内容类型：

<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>

向包中添加新部件时，记住这一点很重要。

# 关系

每个包都包含一个关系部件，该部件定义了其他部件之间以及与包外部资源的关系。这将关系与内容分离，使得在不更改引用目标的源的情况下更改关系变得容易。

![package relationships part](ssImages\rootStructure3.gif)

对于OOXML包，\_rels文件夹中总有一个关系部件(.rels)，用于标识包的起始部件或包关系。例如，以下定义了内容的起始部件的身份：

<Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>.

通常，.rels中还包含app.xml和core.xml的关系。

除了包的关系部件外，每个作为一个或多个关系源的部件都将有自己的关系部件。每个这样的关系部件位于部件的\_rels子文件夹中，并通过在部件名称后附加'.rels'来命名。

通常，主要内容部件(workbook.xml)有自己的关系部件(workbook.xml.rels)。它将包含与内容其他部件的关系，如sheet1.xml、sharedStrings.xml、styles.xml、theme1.xml，以及外部链接的URI。

![document relationships part](ssImages\rootStructure4.gif)

关系可以是显式的或隐式的。对于显式关系，资源使用<Relationship>元素的Id属性引用。也就是说，源中的Id直接映射到关系项的Id，并明确引用目标。

例如，工作表可能包含如下超链接：

<w:hyperlink ref="A11" r:id="rId4">

r:id="rId4"引用工作表的关系部件(worksheet1.xml.rels)中的以下关系。

<Relationship Id="rId4" Type="http://. . ./hyperlink" Target="http://www.google.com/" TargetMode="External"/>

对于隐式关系，没有对<Relationship> Id的直接引用。相反，引用是隐含的。

# 电子表格ML文档特有的部件

以下是电子表格ML包中可能存在的、特定于电子表格ML电子表格的部件列表。请记住，电子表格可能只有其中的几个部件。例如，如果电子表格没有数据透视表，则包中将不包含数据透视表部件。

| 部件               | 描述                                                                                                                                                                                                 |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 计算链             | 当单元格的值从公式计算时，计算顺序可能会受到值计算顺序的影响。此部件包含指定了该顺序。一个包只能包含一个这样的部件。                                                                                 |
| 图表表             | 包含存储在其自己的表中的图表。一个包可以包含多个这样的部件，这些部件从工作簿部件引用。                                                                                                               |
| 注释               | 包含给定工作表的注释。由于可能有多个工作表，所以可能有多个注释部件。                                                                                                                                 |
| 连接               | 电子表格可能有到外部数据源的连接。此部件包含此类连接，解释了如何获取此类外部数据以及连接在工作簿中的使用方式。可能只有一个这样的部件。                                                               |
| 自定义属性         | 包含用户定义的数据。可能有零个或多个这样的部件。                                                                                                                                                     |
| 客户XML映射        | 包含XML文件的架构，以及允许该架构映射到电子表格时要使用的行为信息。可能只有一个这样的部件。                                                                                                          |
| 对话框表           | 包含有关用户窗体的旧客户对话框的信息。可能有零个或多个这样的部件。                                                                                                                                   |
| 绘图               | 包含工作表中存在的一个或多个绘图元素的呈现和布局信息。每个有绘图的工作表都应该有绘图部件。                                                                                                           |
| 外部工作簿引用     | 包含有关在其他电子表格包中引用的数据的信息。例如，电子表格可能有一个单元格，其值是从另一个电子表格中的数据计算的。可能有零个或多个这样的部件。                                                       |
| 元数据             | 包含有关单元格的信息，该单元格的值通过联机分析处理(OLAP)技术与一个或多个其他单元格相关。                                                                                                             |
| 数据透视表         | 包含数据透视表的定义。它描述了数据透视表布局的细节，指示哪些字段在行轴、列轴和数据透视表的值区域上。它还指示数据透视表的格式。包中的每个数据透视表都有一个数据透视表部件。                           |
| 数据透视表缓存定义 | 数据透视表缓存定义定义了数据透视表缓存记录部件（即基础数据）中的每个字段，包括字段名称和有关字段中包含的数据的信息。包中的每个数据透视表都有一个数据透视表缓存定义部件。                             |
| 数据透视表缓存记录 | 包含数据透视表的基础数据。包中的每个数据透视表将有零个或一个这样的部件。                                                                                                                             |
| 查询表             | 包含描述源表如何连接到外部数据源的信息，并定义从源刷新表时使用的属性。每个表可能有一个这样的部件。                                                                                                   |
| 共享字符串表       | 包含工作簿中任何工作表中出现的每个唯一字符串的一次出现。一个包有一个这样的部件。                                                                                                                     |
| 共享工作簿修订日志 | 包含有关在工作簿的工作表中对单个单元格执行的编辑的信息。每个编辑会话应该有一个这样的部件。                                                                                                           |
| 共享工作簿用户数据 | 包含所有共享工作簿的用户的列表。一个包包含零个或一个这样的部件。                                                                                                                                     |
| 单单元格表定义     | 包含有关如何将自定义XML文件中的非重复元素映射到工作表中的单元格的信息。每个工作表可能有一个这样的部件。                                                                                              |
| 样式               | 包含工作簿中所有单元格的所有特征，包括数字和文本格式、对齐方式、字体、颜色和边框。一个包最多包含一个这样的部件。                                                                                     |
| 表定义             | 电子表格可以包含具有明确标记的列、行和数据区域的区域。这样的区域称为表，每个工作表可以有零个或多个表。对于工作表中的每个表，必须有一个包含表描述的表定义部件。（表的数据存储在相应的工作表部件中。） |
| 易失性依赖         | 单元格可以包含实时数据公式，这些公式返回随时间变化的值，并且需要连接到工作簿外部的程序。在这些程序不可用的情况下，公式可以使用存储在易失性依赖部件中的信息。一个包只能有一个这样的部件。             |
| 工作簿             | 包含数据和对所有工作表的引用。必须有一个且仅有一个工作簿部件。                                                                                                                                       |
| 工作表             | 包含给定工作表的所有数据、公式和特征。包中的每个工作表都有一个这样的部件。                                                                                                                           |

# 其他OOXML文档共享的部件

有许多部件类型可能出现在任何OOXML包中。以下是一些与电子表格ML文档更相关的部件。

| 部件                                     | 描述                                                                                                                                                                                   |
| ---------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 嵌入包                                   | 包含一个完整的包，该包可以在引用包的内部或外部。例如，电子表格ML文档可能包含文字处理ML或演示文稿ML文档。                                                                               |
| 扩展文件属性（通常位于docProps/app.xml） | 包含特定于OOXML文档的属性—例如所使用的模板、页数和字数、应用程序名称和版本等属性。                                                                                                     |
| 文件属性，核心                           | 核心文件属性使用户能够发现和设置包中的常见属性—例如创建者名称、创建日期、标题等属性。尽可能使用[Dublin Core](http://dublincore.org/)属性（一组用于描述资源的元数据术语）。             |
| 图像                                     | 电子表格通常包含图像。图像可以作为zip项存储在包中。该项必须通过图像部件关系和适当的内容类型来标识。                                                                                    |
| 主题                                     | DrawingML是OOXML文档类型之间的一种共享语言。它包括一个主题部件，当电子表格使用主题时，该部件包含在电子表格ML文档中。主题部件包含有关文档主题的信息，即配色方案、字体和格式方案等信息。 |

[关于本站](aboutThisSite.md) | [联系我们](contactUs.md)  
版权 © 2023。保留所有权利。
